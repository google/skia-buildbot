load("@rules_go//go:def.bzl", "go_library")
load("//bazel/external:runfile_paths.bzl", "generate_go_runfile_path")

gen_filename, data = generate_go_runfile_path(
    name = "generate_go_runfile_path",
    go_library_name = "git",
    path = "bin/git",  # TODO(borenet): Windows??
    platform_mapping = {
        "@platforms//os:linux": "@git_amd64_linux//:all_files",
        "@platforms//os:windows": "@git_amd64_windows//:all_files",
    },
)

# gazelle:ignore
go_library(
    name = "git",
    srcs = [
        "git.go",
        gen_filename,
    ],
    data = data,
    importpath = "go.skia.org/infra/bazel/external/cipd/git",
    visibility = ["//visibility:public"],
    deps = [
        "//bazel/go/bazel",
        "//go/git/git_common",
    ],
)
